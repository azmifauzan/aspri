#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 5.65kB 0.0s done
#1 DONE 0.1s

#2 [internal] load metadata for docker.io/library/php:8.4-cli
#2 ...

#3 [internal] load metadata for docker.io/library/php:8.4-apache
#3 DONE 3.7s

#4 [internal] load metadata for docker.io/library/composer:2
#4 DONE 3.7s

#2 [internal] load metadata for docker.io/library/php:8.4-cli
#2 DONE 3.8s

#5 [internal] load .dockerignore
#5 transferring context: 841B 0.0s done
#5 DONE 0.1s

#6 [internal] load build context
#6 DONE 0.0s

#7 FROM docker.io/library/composer:2@sha256:e4ff7e012505df43b4404cf73a4590e06a3f752a7f77d9079a89f770d257eb84
#7 resolve docker.io/library/composer:2@sha256:e4ff7e012505df43b4404cf73a4590e06a3f752a7f77d9079a89f770d257eb84
#7 ...

#8 [composer-builder 1/5] FROM docker.io/library/php:8.4-cli@sha256:642ab1689fd3b41abdba5aa5f94d57561adaa3fdb445f0c457a5def17d10b6a7
#8 resolve docker.io/library/php:8.4-cli@sha256:642ab1689fd3b41abdba5aa5f94d57561adaa3fdb445f0c457a5def17d10b6a7 0.4s done
#8 DONE 0.5s

#7 FROM docker.io/library/composer:2@sha256:e4ff7e012505df43b4404cf73a4590e06a3f752a7f77d9079a89f770d257eb84
#7 resolve docker.io/library/composer:2@sha256:e4ff7e012505df43b4404cf73a4590e06a3f752a7f77d9079a89f770d257eb84 0.5s done
#7 DONE 0.5s

#8 [composer-builder 1/5] FROM docker.io/library/php:8.4-cli@sha256:642ab1689fd3b41abdba5aa5f94d57561adaa3fdb445f0c457a5def17d10b6a7
#8 DONE 0.5s

#9 [stage-2  1/17] FROM docker.io/library/php:8.4-apache@sha256:09a65a5d0a1a23a06b39e2271790801da3998329740244a137c31474b03f5465
#9 resolve docker.io/library/php:8.4-apache@sha256:09a65a5d0a1a23a06b39e2271790801da3998329740244a137c31474b03f5465 0.5s done
#9 DONE 0.6s

#6 [internal] load build context
#6 ...

#10 [stage-2  3/17] ADD --chmod=0755 https://github.com/mlocati/docker-php-extension-installer/releases/latest/download/install-php-extensions /usr/local/bin/
#10 DONE 1.8s

#6 [internal] load build context
#6 transferring context: 497.56kB 2.4s
#6 transferring context: 909.28kB 3.5s done
#6 DONE 3.7s

#11 [stage-2  9/17] COPY docker/supervisord.conf /etc/supervisor/supervisord.conf
#11 CACHED

#12 [stage-2  3/17] ADD --chmod=0755 https://github.com/mlocati/docker-php-extension-installer/releases/latest/download/install-php-extensions /usr/local/bin/
#12 CACHED

#13 [stage-2  6/17] RUN a2enmod rewrite headers   && sed -ri -e "s!/var/www/html!/var/www/html/public!g" /etc/apache2/sites-available/*.conf   && sed -ri -e "s!/var/www/html!/var/www/html/public!g" /etc/apache2/apache2.conf /etc/apache2/conf-available/*.conf
#13 CACHED

#14 [stage-2  4/17] RUN install-php-extensions pdo_pgsql pgsql mbstring exif pcntl bcmath gd zip redis     && rm -f /usr/local/bin/install-php-extensions
#14 CACHED

#15 [stage-2  5/17] COPY --from=composer:2 /usr/bin/composer /usr/bin/composer
#15 CACHED

#16 [stage-2  7/17] RUN {         echo "upload_max_filesize = 20M";         echo "post_max_size = 20M";         echo "max_execution_time = 300";         echo "max_input_time = 300";         echo "memory_limit = 256M";     } > /usr/local/etc/php/conf.d/uploads.ini
#16 CACHED

#17 [stage-2  8/17] WORKDIR /var/www/html
#17 CACHED

#18 [stage-2 10/17] COPY docker/app-entrypoint.sh /usr/local/bin/app-entrypoint.sh
#18 CACHED

#19 [stage-2 11/17] COPY docker/health-check.sh /usr/local/bin/health-check.sh
#19 CACHED

#20 [stage-2  2/17] RUN apt-get update && apt-get install -y --no-install-recommends     supervisor     cron     netcat-openbsd     tzdata     && apt-get clean     && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
#20 CACHED

#21 [stage-2 12/17] RUN chmod +x /usr/local/bin/app-entrypoint.sh /usr/local/bin/health-check.sh
#21 CACHED

#22 [composer-builder 3/5] WORKDIR /app
#22 CACHED

#23 [composer-builder 4/5] COPY composer*.json composer.lock ./
#23 CACHED

#24 [composer-builder 2/5] RUN apt-get update && apt-get install -y --no-install-recommends     libpng-dev     libjpeg-dev     libfreetype6-dev     libzip-dev     && docker-php-ext-configure gd --with-freetype --with-jpeg     && docker-php-ext-install gd zip     && apt-get clean     && rm -rf /var/lib/apt/lists/*
#24 CACHED

#25 [composer-builder 5/5] RUN --mount=type=cache,target=/tmp/cache     --mount=from=composer:2,src=/usr/bin/composer,target=/usr/bin/composer     composer install --prefer-dist --no-interaction --optimize-autoloader --no-dev --no-scripts
#25 CACHED

#26 [node-builder  8/17] COPY app ./app
#26 CACHED

#27 [node-builder 10/17] COPY config ./config
#27 CACHED

#28 [node-builder  5/17] RUN --mount=type=cache,target=/root/.npm     npm ci --prefer-offline --no-audit
#28 CACHED

#29 [node-builder 11/17] COPY routes ./routes
#29 CACHED

#30 [node-builder 12/17] COPY database ./database
#30 CACHED

#31 [node-builder  9/17] COPY bootstrap ./bootstrap
#31 CACHED

#32 [node-builder  6/17] COPY --from=composer-builder /app/vendor ./vendor
#32 CACHED

#33 [node-builder  2/17] RUN apt-get update && apt-get install -y --no-install-recommends     nodejs     npm     libsqlite3-dev     && docker-php-ext-install pdo_sqlite     && curl -fsSL https://deb.nodesource.com/setup_24.x | bash -     && apt-get install -y nodejs     && apt-get clean     && rm -rf /var/lib/apt/lists/*
#33 CACHED

#34 [node-builder  3/17] WORKDIR /app
#34 CACHED

#35 [node-builder 13/17] COPY resources ./resources
#35 CACHED

#36 [node-builder 15/17] COPY vite.config.ts tsconfig.json .env.example ./
#36 CACHED

#37 [node-builder  4/17] COPY package*.json ./
#37 CACHED

#38 [node-builder  7/17] COPY artisan composer.json ./
#38 CACHED

#39 [node-builder 14/17] COPY public ./public
#39 CACHED

#40 [node-builder 16/17] COPY storage ./storage
#40 CACHED

#41 [node-builder 17/17] RUN cp .env.example .env && php artisan key:generate     && mkdir -p storage/framework/cache/data storage/framework/sessions storage/framework/views     && touch database/database.sqlite     && echo "DB_DATABASE=/app/database/database.sqlite" >> .env     && php artisan migrate --force     && php artisan wayfinder:generate --with-form     && npm run build
#41 2.026 
#41 2.049 In Connection.php line 838:
#41 2.049                                                                                
#41 2.049   Database file at path [/app/database/database.sqlite] does not exist. Ensur  
#41 2.049   e this is an absolute path to the database. (Connection: sqlite, Database:   
#41 2.049   /app/database/database.sqlite, SQL: select exists (select 1 from "main".sql  
#41 2.050   ite_master where name = 'system_settings' and type = 'table') as "exists")   
#41 2.050                                                                                
#41 2.050 
#41 2.070 In SQLiteConnector.php line 60:
#41 2.070                                                                                
#41 2.070   Database file at path [/app/database/database.sqlite] does not exist. Ensur  
#41 2.070   e this is an absolute path to the database.                                  
#41 2.070                                                                                
#41 2.070 
#41 ERROR: process "/bin/sh -c cp .env.example .env && php artisan key:generate     && mkdir -p storage/framework/cache/data storage/framework/sessions storage/framework/views     && touch database/database.sqlite     && echo \"DB_DATABASE=/app/database/database.sqlite\" >> .env     && php artisan migrate --force     && php artisan wayfinder:generate --with-form     && npm run build" did not complete successfully: exit code: 1

#42 [stage-2 13/17] COPY --chown=www-data:www-data . .
#42 CANCELED
------
 > [node-builder 17/17] RUN cp .env.example .env && php artisan key:generate     && mkdir -p storage/framework/cache/data storage/framework/sessions storage/framework/views     && touch database/database.sqlite     && echo "DB_DATABASE=/app/database/database.sqlite" >> .env     && php artisan migrate --force     && php artisan wayfinder:generate --with-form     && npm run build:
2.049   /app/database/database.sqlite, SQL: select exists (select 1 from "main".sql  
2.050   ite_master where name = 'system_settings' and type = 'table') as "exists")   
2.050                                                                                
2.050 
2.070 In SQLiteConnector.php line 60:
2.070                                                                                
2.070   Database file at path [/app/database/database.sqlite] does not exist. Ensur  
2.070   e this is an absolute path to the database.                                  
2.070                                                                                
2.070 
------
Dockerfile:68
--------------------
  67 |     # Create .env for artisan commands and generate Wayfinder types before build
  68 | >>> RUN cp .env.example .env && php artisan key:generate \
  69 | >>>     && mkdir -p storage/framework/cache/data storage/framework/sessions storage/framework/views \
  70 | >>>     && touch database/database.sqlite \
  71 | >>>     && echo "DB_DATABASE=/app/database/database.sqlite" >> .env \
  72 | >>>     && php artisan migrate --force \
  73 | >>>     && php artisan wayfinder:generate --with-form \
  74 | >>>     && npm run build
  75 |     
--------------------
ERROR: failed to build: failed to solve: process "/bin/sh -c cp .env.example .env && php artisan key:generate     && mkdir -p storage/framework/cache/data storage/framework/sessions storage/framework/views     && touch database/database.sqlite     && echo \"DB_DATABASE=/app/database/database.sqlite\" >> .env     && php artisan migrate --force     && php artisan wayfinder:generate --with-form     && npm run build" did not complete successfully: exit code: 1

View build details: docker-desktop://dashboard/build/desktop-linux/desktop-linux/sfupva0kdy1pimqmnge9nizje
